# ุญู ูุดููุฉ Bucket ุงูุชุฎุฒูู ุงูููููุฏ - ุฎุทูุฉ ุจุฎุทูุฉ

## ๐จ **ุงููุดููุฉ ุงููุคูุฏุฉ:**
```
"statusCode": "404",
"error": "Bucket not found",
"message": "Bucket not found"
```

## ๐ฏ **ุงูุณุจุจ:**
**Bucket `checkins` ุบูุฑ ููุฌูุฏ** ูู Supabase Storage

## ๐๏ธ **ุงูุญู ุงูุดุงูู:**

### **ุงููุฑุญูุฉ ุงูุฃููู: ุฅูุดุงุก Bucket (5 ุฏูุงุฆู)**

#### **1. ุงูุฐูุงุจ ุฅูู Supabase Dashboard:**
- **ุงูุชุญ:** [https://supabase.com/dashboard](https://supabase.com/dashboard)
- **ุณุฌู ุฏุฎูู** ุจุญุณุงุจู
- **ุงุฎุชุฑ ูุดุฑูุนู**

#### **2. ุฅูุดุงุก Bucket ุฌุฏูุฏ:**
- **ูู ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ:** ุงุถุบุท ุนูู **Storage**
- **ุงุถุบุท:** "New Bucket" (ุฃู "ุฅูุดุงุก bucket ุฌุฏูุฏ")
- **ุฃุฏุฎู ุงูุจูุงูุงุช:**
  ```
  Name: checkins
  Public: โ (ููุนู - ููู ุฌุฏุงู!)
  File size limit: 50 MB
  ```
- **ุงุถุบุท:** "Create bucket" (ุฃู "ุฅูุดุงุก")

#### **3. ุชุฃููุฏ ุงูุฅูุดุงุก:**
- **ุชุฃูุฏ ูู** ุธููุฑ bucket `checkins` ูู ุงููุงุฆูุฉ
- **ุชุฃูุฏ ูู** ุฃู Public = true

---

### **ุงููุฑุญูุฉ ุงูุซุงููุฉ: ุฅูุดุงุก RLS Policies (3 ุฏูุงุฆู)**

#### **1. ุงูุฐูุงุจ ุฅูู SQL Editor:**
- **ูู ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ:** ุงุถุบุท ุนูู **SQL Editor**
- **ุงุถุบุท:** "New query" (ุฃู "ุงุณุชุนูุงู ุฌุฏูุฏ")

#### **2. ูุณุฎ ููุตู ุงูุฃูุงูุฑ:**
```sql
-- ุฅูุดุงุก policy ูููุฑุงุกุฉ (ูุทููุจ ูุชุญููู ุงูุตูุฑ)
CREATE POLICY "Allow public read access to checkins bucket" 
ON storage.objects FOR SELECT 
USING (bucket_id = 'checkins');

-- ุฅูุดุงุก policy ูููุชุงุจุฉ (ูุทููุจ ูุญูุธ ุงูุตูุฑ ุงูุฌุฏูุฏุฉ)
CREATE POLICY "Allow public upload to checkins bucket" 
ON storage.objects FOR INSERT 
WITH CHECK (bucket_id = 'checkins');

-- ุฅูุดุงุก policy ููุชุญุฏูุซ (ูุทููุจ ูุชุนุฏูู ุงูุตูุฑ)
CREATE POLICY "Allow public update in checkins bucket" 
ON storage.objects FOR UPDATE 
USING (bucket_id = 'checkins');
```

#### **3. ุชูููุฐ ุงูุฃูุงูุฑ:**
- **ุงุถุบุท:** "Run" (ุฃู "ุชุดุบูู")
- **ุชุฃูุฏ ูู** ุนุฏู ูุฌูุฏ ุฃุฎุทุงุก

---

### **ุงููุฑุญูุฉ ุงูุซุงูุซุฉ: ูุญุต ุญุงูุฉ ุงูุชุฎุฒูู (2 ุฏูููุฉ)**

#### **1. ูุญุต ูุฌูุฏ Bucket:**
```sql
SELECT name, public, file_size_limit 
FROM storage.buckets 
WHERE name = 'checkins';
```

#### **2. ูุญุต Policies:**
```sql
SELECT * 
FROM storage.policies 
WHERE bucket_id = 'checkins';
```

#### **3. ุงููุชุงุฆุฌ ุงููุชููุนุฉ:**
```
name     | public | file_size_limit
---------|--------|----------------
checkins | true   | 52428800
```

---

### **ุงููุฑุญูุฉ ุงูุฑุงุจุนุฉ: ุฑูุน ุตูุฑ ุงุฎุชุจุงุฑ (5 ุฏูุงุฆู)**

#### **1. ุฅูุดุงุก ุตูุฑ ุงุฎุชุจุงุฑ:**
- **ุฃูุดุฆ** ููููู ุตูุฑุฉ:
  - `test_before.jpg` (ุตูุฑุฉ ูุจู)
  - `test_after.jpg` (ุตูุฑุฉ ุจุนุฏ)
- **ุฃู ุงุณุชุฎุฏู** ุฃู ุตูุฑ ููุฌูุฏุฉ ูุฏูู

#### **2. ุฑูุน ุงูุตูุฑ:**
- **ุงุฐูุจ ุฅูู:** Storage > checkins
- **ุงุถุบุท:** "Upload files" (ุฃู "ุฑูุน ูููุงุช")
- **ุงุฎุชุฑ** ุงูุตูุฑ
- **ุงุถุบุท:** "Upload" (ุฃู "ุฑูุน")

#### **3. ุชุฃููุฏ ุงูุฑูุน:**
- **ุชุฃูุฏ ูู** ุธููุฑ ุงูุตูุฑ ูู bucket
- **ุณุฌู** ุฃุณูุงุก ุงููููุงุช ุจุงูุถุจุท

---

### **ุงููุฑุญูุฉ ุงูุฎุงูุณุฉ: ุงุฎุชุจุงุฑ ุงูุชุทุจูู (3 ุฏูุงุฆู)**

#### **1. ูุชุญ ุงูุชุทุจูู:**
- **ุงูุชุญ** ุชุทุจูู Flutter
- **ุงุฐูุจ ุฅูู** ุตูุญุฉ ุชูุงุตูู ุงูุณุฌู
- **ุงุถุบุท** ุนูู "ูุญุต ุงูุชุฎุฒูู"

#### **2. ูุญุต Console:**
- **ุงุจุญุซ ุนู** ูุฐู ุงูุฑุณุงุฆู:
  ```
  Buckets ุงููุชุงุญุฉ: [checkins]
  ูููุงุช ูู bucket checkins: [test_before.jpg, test_after.jpg]
  ```

#### **3. ุงุฎุชุจุงุฑ ุชุญููู ุงูุตูุฑ:**
- **ุงุถุบุท** ุนูู "ุฅุนุงุฏุฉ ุงููุญุงููุฉ"
- **ุชุฃูุฏ ูู** ุนุฏู ุธููุฑ ุฑุณุงุฆู ุฎุทุฃ

---

## ๐ง **ุฃูุงูุฑ SQL ูููุฏุฉ:**

### **1. ูุญุต ุงูุณุฌูุงุช ุงูููุฌูุฏุฉ:**
```sql
SELECT 
    id,
    serial,
    driver_id,
    before_path,
    after_path,
    created_at
FROM checkins 
ORDER BY created_at DESC 
LIMIT 5;
```

### **2. ูุญุต ุงูุณุฌูุงุช ุจุฏูู ุตูุฑ:**
```sql
SELECT 
    id,
    serial,
    driver_id,
    before_path,
    after_path
FROM checkins 
WHERE before_path IS NULL 
   OR after_path IS NULL 
   OR before_path = '' 
   OR after_path = '';
```

### **3. ุชุญุฏูุซ ุงูุณุฌูุงุช (ุงุฎุชูุงุฑู):**
```sql
UPDATE checkins 
SET 
    before_path = 'test_before.jpg',
    after_path = 'test_after.jpg'
WHERE before_path IS NULL 
   OR after_path IS NULL;
```

---

## โ๏ธ **ูุดุงูู ูุญุชููุฉ ูุญููููุง:**

### **1. "Bucket already exists":**
- **ุงูุญู:** ุงุณุชุฎุฏู bucket ููุฌูุฏ ุฃู ุบููุฑ ุงูุงุณู
- **ูุซุงู:** `checkins_images` ุจุฏูุงู ูู `checkins`

### **2. "Policy already exists":**
- **ุงูุญู:** ุชุฌุงูู ุงูุฎุทุฃ - Policy ููุฌูุฏ ุจุงููุนู
- **ุฃู:** ุงุญุฐู Policy ุงููุฏูู ุฃููุงู

### **3. "Permission denied":**
- **ุงูุญู:** ุชุฃูุฏ ูู ุฃู bucket = public
- **ุชุฃูุฏ ูู** RLS policies ุตุญูุญุฉ

### **4. "File not found":**
- **ุงูุญู:** ุชุฃูุฏ ูู ุฑูุน ุงูุตูุฑ
- **ุชุฃูุฏ ูู** ุตุญุฉ ุฃุณูุงุก ุงููููุงุช

---

## ๐ฏ **ุฎุทุฉ ุงูุนูู ุงูููุชุฑุญุฉ:**

### **ุงูููู ุงูุฃูู (15 ุฏูููุฉ):**
1. โ **ุฅูุดุงุก bucket** `checkins`
2. โ **ุฅูุดุงุก RLS policies**
3. โ **ุฑูุน ุตูุฑ ุงุฎุชุจุงุฑ**
4. โ **ุงุฎุชุจุงุฑ ุงูุชุทุจูู**

### **ุงูููู ุงูุซุงูู (10 ุฏูุงุฆู):**
1. โ **ูุญุต ุฌููุน ุงูุณุฌูุงุช**
2. โ **ุชุญุฏูุซ ุงููุณุงุฑุงุช ุงููุงุฑุบุฉ**
3. โ **ุงุฎุชุจุงุฑ ุดุงูู**

### **ุงูููู ุงูุซุงูุซ (5 ุฏูุงุฆู):**
1. โ **ูุฑุงุฌุนุฉ ุงููุชุงุฆุฌ**
2. โ **ุญู ุฃู ูุดุงูู ูุชุจููุฉ**

---

## ๐ฑ **ุงุฎุชุจุงุฑ ุงูุชุทุจูู:**

### **1. ูุญุต ุงูุชุฎุฒูู:**
- **ุงุถุบุท** ุนูู "ูุญุต ุงูุชุฎุฒูู"
- **ุชุฃูุฏ ูู** ุฑุณุงูุฉ ุงููุฌุงุญ
- **ุชุญูู ูู** Console

### **2. ุชุญููู ุงูุตูุฑ:**
- **ุงุถุบุท** ุนูู "ุฅุนุงุฏุฉ ุงููุญุงููุฉ"
- **ุชุฃูุฏ ูู** ุธููุฑ ุงูุตูุฑ
- **ุชุญูู ูู** ุนุฏู ูุฌูุฏ ุฃุฎุทุงุก

### **3. Google Maps:**
- **ุงุถุบุท** ุนูู "ูุชุญ ูู Google Maps"
- **ุชุฃูุฏ ูู** ูุชุญ ุงูุฎุฑูุทุฉ

---

## ๐ **ุงููุชูุฌุฉ ุงููุชููุนุฉ:**

### **ูุจู ุงูุญู:**
```
โ StorageException: Bucket not found
โ ูุง ุชุธูุฑ ุงูุตูุฑ
โ ุฑุณุงุฆู ุฎุทุฃ ุญูุฑุงุก
```

### **ุจุนุฏ ุงูุญู:**
```
โ ุงูุตูุฑ ุชุธูุฑ ุจูุฌุงุญ
โ ูุง ุชูุฌุฏ ุฑุณุงุฆู ุฎุทุฃ
โ ุฒุฑ Google Maps ูุนูู
โ ูุญุต ุงูุชุฎุฒูู ูุงุฌุญ
```

---

## ๐ **ุฅุฐุง ุงุญุชุฌุช ูุณุงุนุฏุฉ:**

### **1. ูุญุต Console:**
- **ุงุจุญุซ ุนู** ุฑุณุงุฆู ุงูุฎุทุฃ
- **ุณุฌู** ุงูุฑุณุงุฆู ุจุงููุงูู

### **2. ูุญุต Supabase:**
- **ุชุฃูุฏ ูู** ูุฌูุฏ bucket
- **ุชุฃูุฏ ูู** RLS policies
- **ุชุฃูุฏ ูู** ุฑูุน ุงูุตูุฑ

### **3. ูุญุต ูุงุนุฏุฉ ุงูุจูุงูุงุช:**
- **ุชุฃูุฏ ูู** ุตุญุฉ ุงููุณุงุฑุงุช
- **ุชุฃูุฏ ูู** ุนุฏู ูุฌูุฏ ููู ูุงุฑุบุฉ

---

**ุงูุขู ุงุชุจุน ุงูุฎุทูุงุช ุจุงูุชุฑุชูุจ ูุณุชุญู ุงููุดููุฉ!** ๐

**ุงูููุช ุงููุทููุจ:** 15 ุฏูููุฉ ููุท
**ุงููุณุชูู:** ูุจุชุฏุฆ
**ุงููุชูุฌุฉ:** ุตูุฑ ุชุนูู + Google Maps ูุนูู

**ูู ุชุฑูุฏ ููู ูุณุงุนุฏุชู ูู ุฃู ุฎุทูุฉ ูุญุฏุฏุฉุ** ๐ค
